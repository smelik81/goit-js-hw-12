{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function searchPhoto(searchImages, page) {\n\n   try {\n     const BASE_URL = 'https://pixabay.com/api/';\n     const API_KEY = '43587882-3fd012595c4df59010c013d1f';\n\n     const { data } = await axios.get(BASE_URL, {\n       params: {\n         key: API_KEY,\n         q: searchImages,\n         image_type: 'photo',\n         orientation: 'horizontal',\n         safesearch: 'true',\n         per_page: 15,\n         page,\n       },\n     });\n       \n     return data;\n   } catch (error) {\n    console.error('Error fetching data, please try again:', error);\n      throw new Error(error.response.status);\n   }\n\n\n};\n\n","export function createMarkup(arr) {\n  return arr.reduce(\n    (\n      html,\n      { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n    ) => {\n      return (html += `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            </a>\n            <div class=\"gallery-block\">\n                <p class=\"gallery-block__description\"><span>likes</span>${likes}</p>\n                <p class=\"gallery-block__description\"><span>views</span>${views}</p>\n                <p class=\"gallery-block__description\"><span>comments</span> ${comments}</p>\n                <p class=\"gallery-block__description\"><span>downloads</span>${downloads}</p>\n            </div>\n        </li>\n        `);\n    },\n    ''\n  );\n};\n\n\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { searchPhoto } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  sourceAttr: 'href',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nconst formSearch = document.querySelector('.js__search-form');\nconst list = document.querySelector('.js__list');\nconst loader = document.querySelector('.loader');\nconst buttonLoad = document.querySelector('.button__load-btn');\n\nlet inputSearchValue;\nlet page = 1;\nlet per_page = 15;\n\nformSearch.addEventListener('submit', handleSubmit);\nbuttonLoad.addEventListener('click', loadNextPage);\n\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n   \n    inputSearchValue = formSearch.elements.picture.value.trim();\n    loader.classList.remove('.hide');\n    list.innerHTML = \"\";\n    \n    try {\n        const data = await searchPhoto(inputSearchValue, page);\n        if (!inputSearchValue) {\n             iziToast.error({\n               title: 'Error',\n               message: 'Sorry, your request is not correct. Please try again!',\n             });\n             loader.classList.add('hide');\n             return;\n        } else {\n          list.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n          lightbox.refresh();\n            const totalPages = Math.ceil(data.totalHits / per_page);\n            \n          if (page < totalPages) {\n              buttonLoad.classList.replace(\"load-more-hidden\", \"load-more\");\n          }\n        }\n    } catch(error) {\n          iziToast.error({\n            title: 'Error',\n            message:\n              'Sorry, there are no images matching your search query. Please try again!',\n            position: 'bottomCenter',\n            transitionIn: 'bounceInUp',\n            messageColor: 'white',\n            timeout: 2000,\n          });\n            loader.classList.add('hide');\n      }\n    finally {\n         loader.classList.add('hide');\n        formSearch.reset();\n    }\n    \n};\n\n\nasync function loadNextPage() {\n    page += 1;\n    buttonLoad.disabled = true;\n\n\n\n    try {\n        const data = await searchPhoto(inputSearchValue, page);\n        const totalPages = Math.ceil(data.totalHits / per_page);\n\n        list.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n        buttonLoad.disabled = false;\n        lightbox.refresh();\n\n        const { height: cardHeight } = document\n          .querySelector('.gallery-item')\n          .getBoundingClientRect();\n        window.scrollBy({\n          top: Math.round(cardHeight) * 2,\n          behavior: 'smooth',\n        });\n\n\n\n        if (page >= totalPages) {\n            buttonLoad.classList.replace('load-more', 'load-more-hidden');\n            iziToast.show({\n                position: 'topRight',\n                message:\n                    \"We're sorry, but you've reached the end of search results.\",\n            });\n        }\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message:\n                'Sorry, there are no images matching your search query. Please try again!',\n            position: 'bottomCenter',\n            transitionIn: 'bounceInUp',\n            messageColor: 'white',\n            timeout: 2000,\n        });\n    }\n};\n"],"names":["searchPhoto","searchImages","page","BASE_URL","API_KEY","data","axios","error","createMarkup","arr","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","formSearch","list","loader","buttonLoad","inputSearchValue","per_page","handleSubmit","loadNextPage","event","totalPages","iziToast","cardHeight"],"mappings":"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"}